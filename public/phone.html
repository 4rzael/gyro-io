<!DOCTYPE html>

<!-- Code HTML du portable, récupère les données du gyroscope et les envoie au serveur -->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Accelerometer Javascript Test</title>
<meta name="viewport" content="width=device-width,user-scalable=yes" />
<style>
body {
	font-family: helvetica, arial, sans serif;
}
</style>
</head>

<body>
<div id="content">
    <h1>Move your phone, and have some fun</h1>
</div>

<script src="/socket.io/socket.io.js"></script>

<script type="text/javascript">

// etablit une connexion temps réel
var socket = io();
	
// s'il y a un gyroscope/accelerometre
if (window.DeviceMotionEvent != undefined) {

	// quand le portable bouge
	window.ondevicemotion = function(e) {
		// envoie les infos au serveur via un message de "type" 'gyro'.
		socket.emit('gyro',
			{
				acceleration: {
					x: event.accelerationIncludingGravity.x,
					y: event.accelerationIncludingGravity.y,
					z: event.accelerationIncludingGravity.z
				},
				rotationRate: e.rotationRate ? {
					alpha: e.rotationRate.alpha,
					beta: e.rotationRate.alpha,
					gamma: e.rotationRate.alpha
				} : undefined
			});
	}
} 

</script>

</body>
</html>
